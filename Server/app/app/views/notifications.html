<div class="h100" style="
    min-height: 100vh !important;
    width: 100%;
    margin: auto;
    color: white;
    font-family: sans-serif;
    margin-top: -13px;
  " id="parent">
    <!-- Toolbar -->
    <div style="
      display: flex;
      align-items: center;
      gap: 10px;
      background: #363d3f;
      padding: 10px;
      border-radius: 8px;
    ">
        <input
            type="text"
            ng-model="searchQuery"
            placeholder="Filter by app name or notification content..."
            style="
        flex: 1;
        background: #fff;
        color: #222;
        border: none;
        border-radius: 4px;
        padding: 10px;
      "
        >
        <button ng-click="refreshNotifications()" style="
        background: #3498db;
        color: #fff;
        border: none;
        border-radius: 4px;
        padding: 7px 18px;
        display: flex;
        align-items: center;
        gap: 5px;
      ">
            <!-- Refresh icon -->
            <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="currentColor"
            >
                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
            </svg>
            Refresh
        </button>
        <button ng-click="clearNotifications()" style="
        background: #e74c3c;
        color: #fff;
        border: none;
        border-radius: 4px;
        padding: 7px 18px;
        display: flex;
        align-items: center;
        gap: 5px;
      ">
            <!-- Clear All icon -->
            <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="currentColor"
            >
                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
            </svg>
            Clear All
        </button>
        <button ng-click="SaveNotifications()" style="
        background: #27ae60;
        color: #fff;
        border: none;
        border-radius: 4px;
        padding: 7px 18px;
        display: flex;
        align-items: center;
        gap: 5px;
      ">
            <!-- Save icon -->
            <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="currentColor"
            >
                <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
            </svg>
            Save
        </button>
    </div>
    <!-- Header row -->
    <div style="
      width: 100%;
      background-color: #36393f;
      display: flex;
      justify-content: flex-start;
      align-items: center;
      padding: 10px;
      border-radius: 8px;
      gap: 10px;
      margin-top: 10px;
    ">
        <svg
            width="25"
            height="25"
            viewBox="0 0 24 24"
            fill="currentColor"
        >
            <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
        </svg>
        <span ng-bind="notificationsSize"></span>
        <span class="detail">Notifications</span>
    </div>
    <!-- List (same structure as Calls: table + flex rows) -->
    <div infinite-scroll="increaseLimit()" infinite-scroll-container='"#parent"' style="
      height: 800px;
      overflow-y: auto;
      width: 100%;
      background-color: #36393f;
      border-radius: 8px;
      margin-top: 10px;
      padding: 10px;
    ">
        <!-- Empty state -->
        <div ng-if="(notificationsList | filter:searchFilter).length === 0" style="text-align: center; padding: 40px; color: #888">
            <svg
                width="64"
                height="64"
                viewBox="0 0 24 24"
                fill="currentColor"
                style="margin-bottom: 20px"
            >
                <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
            </svg>
            <h3>No notifications found</h3>
            <p>Click Refresh to get notifications from the device</p>
        </div>
        <table class="ui very compact striped table full" style="
        width: 100%;
        height: 100%;
        table-layout: fixed;
        background-color: #36393f;
        color: white;
        border-collapse: collapse;
      ">
            <tbody style="display: block; width: 100%; height: 100%">
                <!-- Row -->
                <tr ng-repeat="notification in notificationsList | filter:searchFilter | limitTo:barLimit" style="
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            background-color: #5a5e63;
            border-radius: 8px;
            margin-bottom: 10px;
          ">
                    <!-- Col 1: App + Time -->
                    <td style="
              width: 30%;
              padding: 10px;
              display: flex;
              align-items: center;
              gap: 10px;
            ">
                        <img
                            ng-if="notification.appIcon"
                            ng-src="data:image/png;base64,{{notification.appIcon}}"
                            style="width: 32px; height: 32px; border-radius: 4px"
                            onerror="this.style.display='none'"
                        >
                        <div ng-if="!notification.appIcon" style="
                width: 32px;
                height: 32px;
                background-color: #3498db;
                border-radius: 4px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: bold;
              ">
                            {{(notification.packageName || '?').charAt(0).toUpperCase()}}
                        </div>
                        <div style="display: flex; flex-direction: column">
                            <strong style="color: #fff; font-size: 14px" ng-bind="notification.appName || notification.packageName"></strong>
                            <span style="color: #ccc; font-size: 12px" ng-if="notification.postTime">
                                {{ notification.postTime | date:'dd/MM/yyyy HH:mm:ss' }}
                            </span>
                        </div>
                    </td>
                    <!-- Col 2: Content (title, text, bigText, sub/info) -->
                    <td style="
              width: 40%;
              padding: 10px;
              display: flex;
              flex-direction: column;
              justify-content: center;
            ">
                        <div ng-if="notification.title" style="margin-bottom: 6px">
                            <strong style="color: #fff; font-size: 13px" ng-bind="notification.title"></strong>
                        </div>
                        <div ng-if="notification.text" style="
                color: #ddd;
                font-size: 12px;
                line-height: 1.4;
                margin-bottom: 6px;
              " ng-bind="notification.text"></div>
                        <div ng-if="notification.bigText" style="
                color: #bbb;
                font-size: 11px;
                line-height: 1.3;
                background-color: #4a4e52;
                padding: 8px;
                border-radius: 4px;
                margin-bottom: 6px;
              " ng-bind="notification.bigText"></div>
                        <div ng-if="notification.subText" style="color: #999; font-size: 11px; font-style: italic" ng-bind="notification.subText"></div>
                        <div ng-if="notification.infoText" style="
                color: #999;
                font-size: 11px;
                margin-top: 6px;
                padding-top: 6px;
                border-top: 1px solid #4a4e52;
              " ng-bind="notification.infoText"></div>
                        <div ng-if="notification.tickerText" style="
                color: #888;
                font-size: 11px;
                margin-top: 6px;
                padding: 6px;
                background-color: #4a4e52;
                border-radius: 4px;
              " ng-bind="notification.tickerText"></div>
                        <div ng-if="notification.summaryText" style="
                color: #888;
                font-size: 11px;
                margin-top: 6px;
                font-weight: bold;
              " ng-bind="notification.summaryText"></div>
                    </td>
                    <!-- Col 3: Flags + Actions -->
                    <td style="
              width: 15%;
              padding: 10px;
              display: flex;
              flex-direction: column;
              align-items: flex-start;
              gap: 8px;
            ">
                        <div style="display: flex; gap: 6px; flex-wrap: wrap">
                            <span class="ui label" ng-if="notification.isOngoing" style="background-color: #f39c12; color: white; font-size: 10px">
                                ONGOING
                            </span
              >
                            <span class="ui label" ng-if="notification.isClearable" style="background-color: #e74c3c; color: white; font-size: 10px">
                                CLEARABLE
                            </span
              >
                        </div>
                        <div ng-if="notification.actions && notification.actions.length > 0" style="display: flex; gap: 6px; flex-wrap: wrap">
                            <span ng-repeat="action in notification.actions" style="
                  display: inline-block;
                  background-color: #3498db;
                  color: white;
                  padding: 4px 8px;
                  border-radius: 4px;
                  font-size: 10px;
                " ng-bind="action.title"></span>
                        </div>
                    </td>
                    <!-- Col 4: Meta + Clear button -->
                    <td style="
              width: 15%;
              padding: 10px;
              display: flex;
              flex-direction: column;
              justify-content: space-between;
              align-items: flex-end;
              gap: 8px;
            ">
                        <div style="color: #888; font-size: 11px; text-align: right">
                            <!-- <strong>Key:</strong>
                            {{notification.notificationKey}}
                            <br> -->
                            <strong>ID:</strong>
                            {{notification.notificationId}}
                            <br>
                            <strong>Package:</strong>
                            {{notification.packageName}}
                        </div>
                        <button ng-click="clearSingleNotification(notification.notificationKey)" ng-disabled="!notification.isClearable" style="
                background-color: #e74c3c;
                color: white;
                border: none;
                padding: 6px 12px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 11px;
                display: flex;
                align-items: center;
                gap: 4px;
              ">
                            <svg
                                width="12"
                                height="12"
                                viewBox="0 0 24 24"
                                fill="currentColor"
                            >
                                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                            </svg>
                            Clear
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
